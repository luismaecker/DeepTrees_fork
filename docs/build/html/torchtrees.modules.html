

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>torchtrees.modules &mdash; TorchTrees  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=5929fcd5"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="torchtrees.model" href="torchtrees.model.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            TorchTrees
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Architectural Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="guides.html">Developer Guides</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="torchtrees.html">API Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="torchtrees.dataloading.html">torchtrees.dataloading</a></li>
<li class="toctree-l2"><a class="reference internal" href="torchtrees.datasets.html">torchtrees.datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="torchtrees.model.html">torchtrees.model</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">torchtrees.modules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-torchtrees.modules.indices">torchtrees.modules.indices</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#torchtrees.modules.indices.gci"><code class="docutils literal notranslate"><span class="pre">gci()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchtrees.modules.indices.hue"><code class="docutils literal notranslate"><span class="pre">hue()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchtrees.modules.indices.ndvi"><code class="docutils literal notranslate"><span class="pre">ndvi()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchtrees.modules.indices.ndvi_xarray"><code class="docutils literal notranslate"><span class="pre">ndvi_xarray()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-torchtrees.modules.losses">torchtrees.modules.losses</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#torchtrees.modules.losses.BinarySegmentationLoss"><code class="docutils literal notranslate"><span class="pre">BinarySegmentationLoss</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchtrees.modules.losses.BinarySegmentationLossWithLogits"><code class="docutils literal notranslate"><span class="pre">BinarySegmentationLossWithLogits</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-torchtrees.modules.metrics">torchtrees.modules.metrics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#torchtrees.modules.metrics.iou"><code class="docutils literal notranslate"><span class="pre">iou()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchtrees.modules.metrics.iou_with_logits"><code class="docutils literal notranslate"><span class="pre">iou_with_logits()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#torchtrees-modules-polygon-metrics">torchtrees.modules.polygon_metrics</a></li>
<li class="toctree-l3"><a class="reference internal" href="#torchtrees-modules-polygon-utils">torchtrees.modules.polygon_utils</a></li>
<li class="toctree-l3"><a class="reference internal" href="#torchtrees-modules-postprocessing">torchtrees.modules.postprocessing</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-torchtrees.modules.rasterize_utils">torchtrees.modules.rasterize_utils</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#torchtrees.modules.rasterize_utils.filter_geometry"><code class="docutils literal notranslate"><span class="pre">filter_geometry()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchtrees.modules.rasterize_utils.get_bbox_polygon"><code class="docutils literal notranslate"><span class="pre">get_bbox_polygon()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchtrees.modules.rasterize_utils.get_xarray_trafo"><code class="docutils literal notranslate"><span class="pre">get_xarray_trafo()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchtrees.modules.rasterize_utils.rasterize"><code class="docutils literal notranslate"><span class="pre">rasterize()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchtrees.modules.rasterize_utils.to_outline"><code class="docutils literal notranslate"><span class="pre">to_outline()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchtrees.modules.rasterize_utils.xarray_trafo_to_gdal_trafo"><code class="docutils literal notranslate"><span class="pre">xarray_trafo_to_gdal_trafo()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-torchtrees.modules.traits">torchtrees.modules.traits</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#torchtrees.modules.traits.longest_cross_spread"><code class="docutils literal notranslate"><span class="pre">longest_cross_spread()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchtrees.modules.traits.longest_spread"><code class="docutils literal notranslate"><span class="pre">longest_spread()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchtrees.modules.traits.power_law_exponent"><code class="docutils literal notranslate"><span class="pre">power_law_exponent()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-torchtrees.modules.utils">torchtrees.modules.utils</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#torchtrees.modules.utils.array_to_tif"><code class="docutils literal notranslate"><span class="pre">array_to_tif()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchtrees.modules.utils.calc_band_stats"><code class="docutils literal notranslate"><span class="pre">calc_band_stats()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchtrees.modules.utils.compute_pyramid_patch_weight_loss"><code class="docutils literal notranslate"><span class="pre">compute_pyramid_patch_weight_loss()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchtrees.modules.utils.create_batch_of_patches"><code class="docutils literal notranslate"><span class="pre">create_batch_of_patches()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchtrees.modules.utils.dilate_img"><code class="docutils literal notranslate"><span class="pre">dilate_img()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchtrees.modules.utils.extent_to_poly"><code class="docutils literal notranslate"><span class="pre">extent_to_poly()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchtrees.modules.utils.fix_crs"><code class="docutils literal notranslate"><span class="pre">fix_crs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchtrees.modules.utils.gdal_trafo_to_xarray_trafo"><code class="docutils literal notranslate"><span class="pre">gdal_trafo_to_xarray_trafo()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchtrees.modules.utils.get_crs"><code class="docutils literal notranslate"><span class="pre">get_crs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchtrees.modules.utils.get_map_extent"><code class="docutils literal notranslate"><span class="pre">get_map_extent()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchtrees.modules.utils.get_rioxarray_trafo"><code class="docutils literal notranslate"><span class="pre">get_rioxarray_trafo()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchtrees.modules.utils.get_xarray_extent"><code class="docutils literal notranslate"><span class="pre">get_xarray_extent()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchtrees.modules.utils.get_xarray_trafo"><code class="docutils literal notranslate"><span class="pre">get_xarray_trafo()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchtrees.modules.utils.gpu"><code class="docutils literal notranslate"><span class="pre">gpu()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchtrees.modules.utils.load_filtered_polygons"><code class="docutils literal notranslate"><span class="pre">load_filtered_polygons()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchtrees.modules.utils.load_model_weights"><code class="docutils literal notranslate"><span class="pre">load_model_weights()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchtrees.modules.utils.mask_and_scale_raster_from_polygons"><code class="docutils literal notranslate"><span class="pre">mask_and_scale_raster_from_polygons()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchtrees.modules.utils.overlay_heatmap"><code class="docutils literal notranslate"><span class="pre">overlay_heatmap()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchtrees.modules.utils.predict_on_array"><code class="docutils literal notranslate"><span class="pre">predict_on_array()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchtrees.modules.utils.predict_on_array_cf"><code class="docutils literal notranslate"><span class="pre">predict_on_array_cf()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchtrees.modules.utils.predict_on_tile"><code class="docutils literal notranslate"><span class="pre">predict_on_tile()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchtrees.modules.utils.read_img"><code class="docutils literal notranslate"><span class="pre">read_img()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchtrees.modules.utils.save_polygons"><code class="docutils literal notranslate"><span class="pre">save_polygons()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchtrees.modules.utils.set_batchnorm_momentum"><code class="docutils literal notranslate"><span class="pre">set_batchnorm_momentum()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchtrees.modules.utils.write_info_file"><code class="docutils literal notranslate"><span class="pre">write_info_file()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#torchtrees.modules.utils.xarray_trafo_to_gdal_trafo"><code class="docutils literal notranslate"><span class="pre">xarray_trafo_to_gdal_trafo()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-torchtrees.modules">Contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">TorchTrees</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="torchtrees.html">API Reference</a></li>
      <li class="breadcrumb-item active">torchtrees.modules</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/torchtrees.modules.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="torchtrees-modules">
<h1>torchtrees.modules<a class="headerlink" href="#torchtrees-modules" title="Link to this heading"></a></h1>
<section id="module-torchtrees.modules.indices">
<span id="torchtrees-modules-indices"></span><h2>torchtrees.modules.indices<a class="headerlink" href="#module-torchtrees.modules.indices" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="torchtrees.modules.indices.gci">
<span class="sig-prename descclassname"><span class="pre">torchtrees.modules.indices.</span></span><span class="sig-name descname"><span class="pre">gci</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">red</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">green</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchtrees/modules/indices.html#gci"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchtrees.modules.indices.gci" title="Link to this definition"></a></dt>
<dd><p>Calculates the Green Chlorophyll Index (GCI) from a given image. Implicitly converts to Float32.</p>
<p>Parameters:
img (numpy.ndarray): The input image array.
red (int): The index of the red band in the image.
green (int): The index of the green band in the image.
nir (int): The index of the near-infrared (NIR) band in the image.
axis (int, optional): The axis along which the bands are indexed. Default is -1.</p>
<p>Returns:
numpy.ndarray: The calculated Green Chlorophyll Index (GCI) as a float32 array.</p>
<p>Raises:
ValueError: If the specified axis is not supported.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="torchtrees.modules.indices.hue">
<span class="sig-prename descclassname"><span class="pre">torchtrees.modules.indices.</span></span><span class="sig-name descname"><span class="pre">hue</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">red</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">green</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blue</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchtrees/modules/indices.html#hue"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchtrees.modules.indices.hue" title="Link to this definition"></a></dt>
<dd><p>Calculates the Hue from a given image. Implicitly converts to Float32.</p>
<p>Parameters:
img (numpy.ndarray): The input image array.
red (int): The index of the red channel.
green (int): The index of the green channel.
blue (int): The index of the blue channel.
axis (int, optional): The axis along which to calculate the hue. Default is -1 (last axis).</p>
<p>Returns:
numpy.ndarray: The calculated hue values.</p>
<p>Raises:
ValueError: If the specified axis is not supported.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="torchtrees.modules.indices.ndvi">
<span class="sig-prename descclassname"><span class="pre">torchtrees.modules.indices.</span></span><span class="sig-name descname"><span class="pre">ndvi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">red</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchtrees/modules/indices.html#ndvi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchtrees.modules.indices.ndvi" title="Link to this definition"></a></dt>
<dd><p>Calculates the Normalized Difference Vegetation Index (NDVI) from a given image.</p>
<p>NDVI is calculated using the formula: (NIR - Red) / (NIR + Red + 1E-10)
The function implicitly converts the input image bands to Float32 to ensure precision.</p>
<p>Parameters:
img (numpy.ndarray): The input image array.
red (int): The index of the red band in the image array.
nir (int): The index of the near-infrared (NIR) band in the image array.
axis (int, optional): The axis along which the bands are indexed. Default is -1.</p>
<blockquote>
<div><p>-1 or 2 indicates that the bands are in the last dimension.
0 indicates that the bands are in the first dimension.</p>
</div></blockquote>
<p>Returns:
numpy.ndarray: The NDVI values as a float32 array.</p>
<p>Raises:
ValueError: If the specified axis is not supported.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="torchtrees.modules.indices.ndvi_xarray">
<span class="sig-prename descclassname"><span class="pre">torchtrees.modules.indices.</span></span><span class="sig-name descname"><span class="pre">ndvi_xarray</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">red</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchtrees/modules/indices.html#ndvi_xarray"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchtrees.modules.indices.ndvi_xarray" title="Link to this definition"></a></dt>
<dd><p>Calculates the Normalized Difference Vegetation Index (NDVI) from a given image.</p>
<p>NDVI is calculated using the formula: (NIR - Red) / (NIR + Red + 1E-10).
The input image bands are implicitly converted to Float32 for the calculation.</p>
<p>Parameters:
img (xarray.DataArray): The input image as an xarray DataArray.
red (int or str): The band index or name corresponding to the red band.
nir (int or str): The band index or name corresponding to the near-infrared (NIR) band.</p>
<p>Returns:
xarray.DataArray: The NDVI values as an xarray DataArray.</p>
</dd></dl>

</section>
<section id="module-torchtrees.modules.losses">
<span id="torchtrees-modules-losses"></span><h2>torchtrees.modules.losses<a class="headerlink" href="#module-torchtrees.modules.losses" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="torchtrees.modules.losses.BinarySegmentationLoss">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">torchtrees.modules.losses.</span></span><span class="sig-name descname"><span class="pre">BinarySegmentationLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iou_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchtrees/modules/losses.html#BinarySegmentationLoss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchtrees.modules.losses.BinarySegmentationLoss" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">_Loss</span></code></p>
<p>Combines binary cross entropy loss with -log(iou).
Works with probabilities, so after applying sigmoid activation.</p>
<dl class="py method">
<dt class="sig sig-object py" id="torchtrees.modules.losses.BinarySegmentationLoss.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iou_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchtrees/modules/losses.html#BinarySegmentationLoss.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchtrees.modules.losses.BinarySegmentationLoss.__init__" title="Link to this definition"></a></dt>
<dd><p>Initialize internal Module state, shared by both nn.Module and ScriptModule.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torchtrees.modules.losses.BinarySegmentationLoss.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchtrees/modules/losses.html#BinarySegmentationLoss.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchtrees.modules.losses.BinarySegmentationLoss.forward" title="Link to this definition"></a></dt>
<dd><p>Computes the custom loss function which is a combination of Binary Cross-Entropy (BCE) loss and
Intersection over Union (IoU) loss.
Parameters:
———–
y_pred : torch.Tensor</p>
<blockquote>
<div><p>The predicted output tensor from the model. It should have the same shape as <cite>y_true</cite>.</p>
</div></blockquote>
<dl class="simple">
<dt>y_true<span class="classifier">torch.Tensor</span></dt><dd><p>The ground truth tensor. It should have the same shape as <cite>y_pred</cite>.</p>
</dd>
</dl>
<section id="returns">
<h3>Returns:<a class="headerlink" href="#returns" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>torch.Tensor</dt><dd><p>The computed loss value which is a weighted sum of BCE loss and the negative logarithm of IoU.</p>
</dd>
</dl>
</section>
<section id="notes">
<h3>Notes:<a class="headerlink" href="#notes" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>The BCE loss is weighted by <cite>(1 - self.iou_weight)</cite>.</p></li>
<li><p>The IoU loss is weighted by <cite>self.iou_weight</cite> and is computed as the negative logarithm of the IoU.</p></li>
<li><p>Ensure that <cite>iou</cite> function is defined and computes the Intersection over Union correctly.</p></li>
</ul>
</section>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="torchtrees.modules.losses.BinarySegmentationLossWithLogits">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">torchtrees.modules.losses.</span></span><span class="sig-name descname"><span class="pre">BinarySegmentationLossWithLogits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iou_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchtrees/modules/losses.html#BinarySegmentationLossWithLogits"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchtrees.modules.losses.BinarySegmentationLossWithLogits" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">_Loss</span></code></p>
<p>Combines binary cross entropy loss with -log(iou).
Works with logits - don’t apply sigmoid to your network output.</p>
<dl class="py method">
<dt class="sig sig-object py" id="torchtrees.modules.losses.BinarySegmentationLossWithLogits.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iou_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchtrees/modules/losses.html#BinarySegmentationLossWithLogits.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchtrees.modules.losses.BinarySegmentationLossWithLogits.__init__" title="Link to this definition"></a></dt>
<dd><p>Initialize internal Module state, shared by both nn.Module and ScriptModule.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torchtrees.modules.losses.BinarySegmentationLossWithLogits.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchtrees/modules/losses.html#BinarySegmentationLossWithLogits.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchtrees.modules.losses.BinarySegmentationLossWithLogits.forward" title="Link to this definition"></a></dt>
<dd><p>Computes the loss by combining Binary Cross-Entropy (BCE) loss and Intersection over Union (IoU) loss.
:type y_pred: 
:param y_pred: The predicted output tensor from the model. This tensor typically contains</p>
<blockquote>
<div><p>the predicted probabilities for each class.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>y_true</strong> (<em>torch.Tensor</em>) – The ground truth tensor. This tensor contains the actual class labels.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The computed loss value which is a combination of BCE loss and IoU loss.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
<p>The loss is calculated as follows:
1. Compute the BCE loss between the predicted and true values.
2. Compute the IoU loss between the predicted and true values.
3. Combine the two losses using the <cite>iou_weight</cite> attribute to balance their contributions.
.. note:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>- The `iou_weight` attribute should be defined in the class to control the balance between BCE and IoU losses.
- The `bceloss` method should be defined in the class to compute the BCE loss.
- The `iou_with_logits` function should be defined to compute the IoU loss with logits.
</pre></div>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="module-torchtrees.modules.metrics">
<span id="torchtrees-modules-metrics"></span><h2>torchtrees.modules.metrics<a class="headerlink" href="#module-torchtrees.modules.metrics" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="torchtrees.modules.metrics.iou">
<span class="sig-prename descclassname"><span class="pre">torchtrees.modules.metrics.</span></span><span class="sig-name descname"><span class="pre">iou</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchtrees/modules/metrics.html#iou"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchtrees.modules.metrics.iou" title="Link to this definition"></a></dt>
<dd><p>Calculate the Intersection over Union (IoU) between two tensors.
The IoU is a measure of the overlap between two sets, defined as the
intersection divided by the union of the sets. It is commonly used
in image segmentation tasks to evaluate the accuracy of predictions.
:type y_pred: 
:param y_pred: Predicted tensor, typically a binary mask.
:type y_pred: torch.Tensor
:type y_true: 
:param y_true: Ground truth tensor, typically a binary mask.
:type y_true: torch.Tensor</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>The IoU score, a value between 0 and 1, where 1 indicates</dt><dd><p>perfect overlap and 0 indicates no overlap.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>The function uses a small epsilon value to avoid division by zero.</p></li>
<li><p>Both input tensors should have the same shape.</p></li>
<li><p>The tensors are expected to be of type torch.float32.</p></li>
</ul>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="torchtrees.modules.metrics.iou_with_logits">
<span class="sig-prename descclassname"><span class="pre">torchtrees.modules.metrics.</span></span><span class="sig-name descname"><span class="pre">iou_with_logits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchtrees/modules/metrics.html#iou_with_logits"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchtrees.modules.metrics.iou_with_logits" title="Link to this definition"></a></dt>
<dd><p>Compute the Intersection over Union (IoU) score with logits.
This function applies a sigmoid activation to the predicted logits and then
calculates the IoU score between the predicted and true values.
:type y_pred: 
:param y_pred: The predicted logits tensor. This tensor should contain raw, unnormalized scores.
:type y_pred: torch.Tensor
:type y_true: 
:param y_true: The ground truth binary tensor. This tensor should contain binary values (0 or 1).
:type y_true: torch.Tensor</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The IoU score between the predicted and true values.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">y_pred</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y_true</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iou_score</span> <span class="o">=</span> <span class="n">iou_with_logits</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">y_true</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">iou_score</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="torchtrees-modules-polygon-metrics">
<h2>torchtrees.modules.polygon_metrics<a class="headerlink" href="#torchtrees-modules-polygon-metrics" title="Link to this heading"></a></h2>
</section>
<section id="torchtrees-modules-polygon-utils">
<h2>torchtrees.modules.polygon_utils<a class="headerlink" href="#torchtrees-modules-polygon-utils" title="Link to this heading"></a></h2>
</section>
<section id="torchtrees-modules-postprocessing">
<h2>torchtrees.modules.postprocessing<a class="headerlink" href="#torchtrees-modules-postprocessing" title="Link to this heading"></a></h2>
</section>
<section id="module-torchtrees.modules.rasterize_utils">
<span id="torchtrees-modules-rasterize-utils"></span><h2>torchtrees.modules.rasterize_utils<a class="headerlink" href="#module-torchtrees.modules.rasterize_utils" title="Link to this heading"></a></h2>
<p>Utils for creating ground truth raster files from polygons.</p>
<dl class="py function">
<dt class="sig sig-object py" id="torchtrees.modules.rasterize_utils.filter_geometry">
<span class="sig-prename descclassname"><span class="pre">torchtrees.modules.rasterize_utils.</span></span><span class="sig-name descname"><span class="pre">filter_geometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">polygons</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_classes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_column_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'class'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchtrees/modules/rasterize_utils.html#filter_geometry"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchtrees.modules.rasterize_utils.filter_geometry" title="Link to this definition"></a></dt>
<dd><p>Filter the provided polygons by keeping only valid classes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>polygons</strong> (<em>gpd.GeoDataFrame</em>) – GeoDataFrame containing the polygons and class labels.</p></li>
<li><p><strong>valid_classes</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>list</em><em>]</em>) – List of valid class labels. Defaults to ‘all’ (use all classes).</p></li>
<li><p><strong>class_column_name</strong> (<em>str</em>) – Column name of class labels in src. Defaults to ‘class’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>filtered list of Polygons</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[Polygon]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="torchtrees.modules.rasterize_utils.get_bbox_polygon">
<span class="sig-prename descclassname"><span class="pre">torchtrees.modules.rasterize_utils.</span></span><span class="sig-name descname"><span class="pre">get_bbox_polygon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchtrees/modules/rasterize_utils.html#get_bbox_polygon"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchtrees.modules.rasterize_utils.get_bbox_polygon" title="Link to this definition"></a></dt>
<dd><p>Get the Polygon representing the bounding box
of the tile in input_file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>input_file</strong> (<em>str</em>) – path to input file</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>bounding box polygon</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Polygon</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="torchtrees.modules.rasterize_utils.get_xarray_trafo">
<span class="sig-prename descclassname"><span class="pre">torchtrees.modules.rasterize_utils.</span></span><span class="sig-name descname"><span class="pre">get_xarray_trafo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchtrees/modules/rasterize_utils.html#get_xarray_trafo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchtrees.modules.rasterize_utils.get_xarray_trafo" title="Link to this definition"></a></dt>
<dd><p>Returns
xmin, xmax, ymin, ymax, xres, yres
of an xarray. xres and yres can be negative.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="torchtrees.modules.rasterize_utils.rasterize">
<span class="sig-prename descclassname"><span class="pre">torchtrees.modules.rasterize_utils.</span></span><span class="sig-name descname"><span class="pre">rasterize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source_raster</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim_ordering</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'HWC'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchtrees/modules/rasterize_utils.html#rasterize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchtrees.modules.rasterize_utils.rasterize" title="Link to this definition"></a></dt>
<dd><p>Rasterizes the features (polygons/lines) within the extent of the given xarray with the same resolution, all in-memory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>source_raster</strong> – Xarray</p></li>
<li><p><strong>features</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></span>) – List of shapely objects</p></li>
<li><p><strong>dim_ordering</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></span>) – One of CHW (default) or HWC (height, widht, channels)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Rasterized features</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="torchtrees.modules.rasterize_utils.to_outline">
<span class="sig-prename descclassname"><span class="pre">torchtrees.modules.rasterize_utils.</span></span><span class="sig-name descname"><span class="pre">to_outline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">polygons</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchtrees/modules/rasterize_utils.html#to_outline"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchtrees.modules.rasterize_utils.to_outline" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>polygons</strong> (<em>list</em><em>[</em><em>Polygon</em><em>]</em>) – list of polygons</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>TODO type list of boundaries of the polygons</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>_type_</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="torchtrees.modules.rasterize_utils.xarray_trafo_to_gdal_trafo">
<span class="sig-prename descclassname"><span class="pre">torchtrees.modules.rasterize_utils.</span></span><span class="sig-name descname"><span class="pre">xarray_trafo_to_gdal_trafo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xarray_trafo</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchtrees/modules/rasterize_utils.html#xarray_trafo_to_gdal_trafo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchtrees.modules.rasterize_utils.xarray_trafo_to_gdal_trafo" title="Link to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-torchtrees.modules.traits">
<span id="torchtrees-modules-traits"></span><h2>torchtrees.modules.traits<a class="headerlink" href="#module-torchtrees.modules.traits" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="torchtrees.modules.traits.longest_cross_spread">
<span class="sig-prename descclassname"><span class="pre">torchtrees.modules.traits.</span></span><span class="sig-name descname"><span class="pre">longest_cross_spread</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">polygon</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchtrees/modules/traits.html#longest_cross_spread"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchtrees.modules.traits.longest_cross_spread" title="Link to this definition"></a></dt>
<dd><p>Calculate the longest cross spread of a given polygon.
The longest cross spread is defined as the maximum distance between two points
on the polygon’s boundary that are perpendicular to the longest spread line of the polygon.
Parameters:
polygon (shapely.geometry.Polygon): The input polygon for which the longest cross spread is calculated.
Returns:
tuple: A tuple containing:</p>
<blockquote>
<div><ul class="simple">
<li><p>max_cross_distance (float): The maximum cross distance found.</p></li>
<li><p>cross_point_pair (tuple): A tuple of two shapely.geometry.Point objects representing the endpoints of the longest cross spread.
If the polygon is None or invalid, or if no valid cross spread is found, returns (None, None).</p></li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="torchtrees.modules.traits.longest_spread">
<span class="sig-prename descclassname"><span class="pre">torchtrees.modules.traits.</span></span><span class="sig-name descname"><span class="pre">longest_spread</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">polygon</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchtrees/modules/traits.html#longest_spread"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchtrees.modules.traits.longest_spread" title="Link to this definition"></a></dt>
<dd><p>Calculate the longest distance between any two points on the exterior of a polygon.
Parameters:
polygon (shapely.geometry.Polygon): A shapely Polygon object. If the polygon is None or not a valid polygon, the function returns (None, None).
Returns:
tuple: A tuple containing the maximum distance (float) and the pair of points (tuple of shapely.geometry.Point) that are farthest apart.</p>
<blockquote>
<div><p>If the polygon is invalid, returns (None, None).</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="torchtrees.modules.traits.power_law_exponent">
<span class="sig-prename descclassname"><span class="pre">torchtrees.modules.traits.</span></span><span class="sig-name descname"><span class="pre">power_law_exponent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">crown_spread</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crown_area</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchtrees/modules/traits.html#power_law_exponent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchtrees.modules.traits.power_law_exponent" title="Link to this definition"></a></dt>
<dd><p>Calculate the power-law exponent for crown spread and crown area.
Parameters:
crown_spread (float): The crown spread value.
crown_area (float): The crown area value.
Returns:
float: The power-law exponent for crown spread and crown area.</p>
</dd></dl>

</section>
<section id="module-torchtrees.modules.utils">
<span id="torchtrees-modules-utils"></span><h2>torchtrees.modules.utils<a class="headerlink" href="#module-torchtrees.modules.utils" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="torchtrees.modules.utils.array_to_tif">
<span class="sig-prename descclassname"><span class="pre">torchtrees.modules.utils.</span></span><span class="sig-name descname"><span class="pre">array_to_tif</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dst_filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_bands</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'multi'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_background</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src_raster</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchtrees/modules/utils.html#array_to_tif"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchtrees.modules.utils.array_to_tif" title="Link to this definition"></a></dt>
<dd><p>Takes a numpy array and writes a tif. Uses deflate compression.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array</strong> (<em>np.ndarray</em>) – Numpy array.</p></li>
<li><p><strong>dst_filename</strong> (<em>str</em>) – Destination file name/path.</p></li>
<li><p><strong>num_bands</strong> (<em>str</em>) – ‘single’ or ‘multi’. If ‘single’ is chosen, everything is saved into one layer.</p></li>
<li><p><strong>save_background</strong> (<em>bool</em>) – Whether or not to save the last layer, which is often the background class.</p></li>
<li><p><strong>src_raster</strong> (<em>str</em>) – Raster file used to determine the corner coords.</p></li>
<li><p><strong>transform</strong> – A geotransform in the gdal format.</p></li>
<li><p><strong>crs</strong> – A coordinate reference system as proj4 string.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="torchtrees.modules.utils.calc_band_stats">
<span class="sig-prename descclassname"><span class="pre">torchtrees.modules.utils.</span></span><span class="sig-name descname"><span class="pre">calc_band_stats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fpath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchtrees/modules/utils.html#calc_band_stats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchtrees.modules.utils.calc_band_stats" title="Link to this definition"></a></dt>
<dd><p>Calculates the mean and standard deviation of each band in a raster file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fpath</strong> (<em>str</em>) – Path to the raster file.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary containing the mean and standard deviation of each band.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="torchtrees.modules.utils.compute_pyramid_patch_weight_loss">
<span class="sig-prename descclassname"><span class="pre">torchtrees.modules.utils.</span></span><span class="sig-name descname"><span class="pre">compute_pyramid_patch_weight_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchtrees/modules/utils.html#compute_pyramid_patch_weight_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchtrees.modules.utils.compute_pyramid_patch_weight_loss" title="Link to this definition"></a></dt>
<dd><p>Compute a weight matrix that assigns bigger weight on pixels in center and
less weight to pixels on image boundary.
This weight matrix is then used for merging individual tile predictions and helps dealing
with prediction artifacts on tile boundaries.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>width</strong> (<em>int</em>) – Tile width.</p></li>
<li><p><strong>height</strong> (<em>int</em>) – Tile height.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The weight mask.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="torchtrees.modules.utils.create_batch_of_patches">
<span class="sig-prename descclassname"><span class="pre">torchtrees.modules.utils.</span></span><span class="sig-name descname"><span class="pre">create_batch_of_patches</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_ixs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">local_batch_size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchtrees/modules/utils.html#create_batch_of_patches"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchtrees.modules.utils.create_batch_of_patches" title="Link to this definition"></a></dt>
<dd><p>Helper function to create a batch of small patches.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_tensor</strong> (<em>torch.Tensor</em>) – Original input tensor.</p></li>
<li><p><strong>patch_size</strong> (<em>int</em>) – Small patch size.</p></li>
<li><p><strong>patch_ixs</strong> (<em>list</em>) – List of tuples specifying (x_start, y_start) for the small patches in the input tensor.</p></li>
<li><p><strong>offset</strong> (<em>int</em>) – Offset of current batch in patch_ixs.</p></li>
<li><p><strong>local_batch_size</strong> (<em>int</em>) – Size of the batch of small patches.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>One batch of small patches to be used in inference.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="torchtrees.modules.utils.dilate_img">
<span class="sig-prename descclassname"><span class="pre">torchtrees.modules.utils.</span></span><span class="sig-name descname"><span class="pre">dilate_img</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'square'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchtrees/modules/utils.html#dilate_img"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchtrees.modules.utils.dilate_img" title="Link to this definition"></a></dt>
<dd><p>Dilates an image using a specified structuring element.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (<em>np.ndarray</em>) – The input image.</p></li>
<li><p><strong>size</strong> (<em>int</em>) – The size of the structuring element.</p></li>
<li><p><strong>shape</strong> (<em>str</em>) – The shape of the structuring element (‘square’ or ‘disk’).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The dilated image.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="torchtrees.modules.utils.extent_to_poly">
<span class="sig-prename descclassname"><span class="pre">torchtrees.modules.utils.</span></span><span class="sig-name descname"><span class="pre">extent_to_poly</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xarr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchtrees/modules/utils.html#extent_to_poly"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchtrees.modules.utils.extent_to_poly" title="Link to this definition"></a></dt>
<dd><p>Returns the bounding box of an xarray as a shapely polygon.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>xarr</strong> – The xarray.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The bounding box polygon.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Polygon</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="torchtrees.modules.utils.fix_crs">
<span class="sig-prename descclassname"><span class="pre">torchtrees.modules.utils.</span></span><span class="sig-name descname"><span class="pre">fix_crs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_crs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4326</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_crs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">25832</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchtrees/modules/utils.html#fix_crs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchtrees.modules.utils.fix_crs" title="Link to this definition"></a></dt>
<dd><p>Fixes the CRS of a GeoDataFrame if necessary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> (<em>gpd.GeoDataFrame</em>) – The input GeoDataFrame.</p></li>
<li><p><strong>is_crs</strong> (<em>int</em>) – The initial CRS.</p></li>
<li><p><strong>target_crs</strong> (<em>int</em>) – The target CRS.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The GeoDataFrame with the fixed CRS.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>gpd.GeoDataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="torchtrees.modules.utils.gdal_trafo_to_xarray_trafo">
<span class="sig-prename descclassname"><span class="pre">torchtrees.modules.utils.</span></span><span class="sig-name descname"><span class="pre">gdal_trafo_to_xarray_trafo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gdal_trafo</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchtrees/modules/utils.html#gdal_trafo_to_xarray_trafo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchtrees.modules.utils.gdal_trafo_to_xarray_trafo" title="Link to this definition"></a></dt>
<dd><p>Converts a GDAL transform to an xarray transform.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>gdal_trafo</strong> – The GDAL transform.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The xarray transform.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="torchtrees.modules.utils.get_crs">
<span class="sig-prename descclassname"><span class="pre">torchtrees.modules.utils.</span></span><span class="sig-name descname"><span class="pre">get_crs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchtrees/modules/utils.html#get_crs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchtrees.modules.utils.get_crs" title="Link to this definition"></a></dt>
<dd><p>Retrieves the CRS from an xarray.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>array</strong> (<em>xarray.DataArray</em>) – The input xarray.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The CRS.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="torchtrees.modules.utils.get_map_extent">
<span class="sig-prename descclassname"><span class="pre">torchtrees.modules.utils.</span></span><span class="sig-name descname"><span class="pre">get_map_extent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gdal_raster</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchtrees/modules/utils.html#get_map_extent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchtrees.modules.utils.get_map_extent" title="Link to this definition"></a></dt>
<dd><p>Returns a dict of {xmin, xmax, ymin, ymax, xres, yres} of a given GDAL raster file.
Returns None if no geo reference was found.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>gdal_raster</strong> – File opened via gdal.Open().</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary containing the map extent.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="torchtrees.modules.utils.get_rioxarray_trafo">
<span class="sig-prename descclassname"><span class="pre">torchtrees.modules.utils.</span></span><span class="sig-name descname"><span class="pre">get_rioxarray_trafo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchtrees/modules/utils.html#get_rioxarray_trafo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchtrees.modules.utils.get_rioxarray_trafo" title="Link to this definition"></a></dt>
<dd><p>Get the transform from a raster tile.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>arr</strong> (<em>xarray.DataArray</em>) – Raster tile.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The transform of the raster tile.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="torchtrees.modules.utils.get_xarray_extent">
<span class="sig-prename descclassname"><span class="pre">torchtrees.modules.utils.</span></span><span class="sig-name descname"><span class="pre">get_xarray_extent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchtrees/modules/utils.html#get_xarray_extent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchtrees.modules.utils.get_xarray_extent" title="Link to this definition"></a></dt>
<dd><p>Returns the extent of an xarray.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>arr</strong> – The xarray.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The extent of the xarray.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="torchtrees.modules.utils.get_xarray_trafo">
<span class="sig-prename descclassname"><span class="pre">torchtrees.modules.utils.</span></span><span class="sig-name descname"><span class="pre">get_xarray_trafo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchtrees/modules/utils.html#get_xarray_trafo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchtrees.modules.utils.get_xarray_trafo" title="Link to this definition"></a></dt>
<dd><p>Returns the transform of an xarray.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>arr</strong> – The xarray.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The transform of the xarray.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="torchtrees.modules.utils.gpu">
<span class="sig-prename descclassname"><span class="pre">torchtrees.modules.utils.</span></span><span class="sig-name descname"><span class="pre">gpu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cuda'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">torch.float32</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchtrees/modules/utils.html#gpu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchtrees.modules.utils.gpu" title="Link to this definition"></a></dt>
<dd><p>Moves a tensor to the GPU if available.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>torch.Tensor</em>) – The tensor to move.</p></li>
<li><p><strong>device</strong> (<em>str</em>) – The device to move the tensor to.</p></li>
<li><p><strong>dtype</strong> (<em>torch.dtype</em>) – The data type of the tensor.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The tensor on the specified device.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="torchtrees.modules.utils.load_filtered_polygons">
<span class="sig-prename descclassname"><span class="pre">torchtrees.modules.utils.</span></span><span class="sig-name descname"><span class="pre">load_filtered_polygons</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">file,</span> <span class="pre">rasters,</span> <span class="pre">minimum_area=0,</span> <span class="pre">maximum_area=1000000,</span> <span class="pre">filter_dict={},</span> <span class="pre">operators=[&lt;built-in</span> <span class="pre">function</span> <span class="pre">eq&gt;]</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchtrees/modules/utils.html#load_filtered_polygons"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchtrees.modules.utils.load_filtered_polygons" title="Link to this definition"></a></dt>
<dd><p>Loads those polygons from a given shapefile which fit into the extents of the given rasters.</p>
<p>Polygons will be cropped to fit the given raster extent.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file</strong> (<em>str</em>) – Shapefile path.</p></li>
<li><p><strong>rasters</strong> (<em>list</em>) – List of xarrays.</p></li>
<li><p><strong>minimum_area</strong> (<em>float</em>) – Minimum polygon area in map units (typically m²), measured after cropping to extent.</p></li>
<li><p><strong>maximum_area</strong> (<em>float</em>) – Maximum polygon area in map units (typically m²), measured after cropping to extent.</p></li>
<li><p><strong>filter_dict</strong> (<em>dict</em>) – Dictionary of key value pairs to filter polygons by.</p></li>
<li><p><strong>operators</strong> (<em>list</em>) – A list of built-in python comparison operators from the ‘operator’ package.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of lists containing polygons in the same order as the rasters.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="torchtrees.modules.utils.load_model_weights">
<span class="sig-prename descclassname"><span class="pre">torchtrees.modules.utils.</span></span><span class="sig-name descname"><span class="pre">load_model_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchtrees/modules/utils.html#load_model_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchtrees.modules.utils.load_model_weights" title="Link to this definition"></a></dt>
<dd><p>Loads the models weights and sets the batch norm momentum to 0.9.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – The model to load weights into.</p></li>
<li><p><strong>path</strong> (<em>str</em>) – Path to the weights file.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The model with loaded weights.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="torchtrees.modules.utils.mask_and_scale_raster_from_polygons">
<span class="sig-prename descclassname"><span class="pre">torchtrees.modules.utils.</span></span><span class="sig-name descname"><span class="pre">mask_and_scale_raster_from_polygons</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tiff_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">polygons</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchtrees/modules/utils.html#mask_and_scale_raster_from_polygons"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchtrees.modules.utils.mask_and_scale_raster_from_polygons" title="Link to this definition"></a></dt>
<dd><p>Masks and optionally scales raster images based on given polygons.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tiff_path</strong> (<em>str</em>) – Path to the input GeoTIFF file.</p></li>
<li><p><strong>polygons</strong> (<em>list</em>) – A list of shapely geometries (polygons).</p></li>
<li><p><strong>output_dir</strong> (<em>str</em>) – Directory to save the masked raster files.</p></li>
<li><p><strong>scale_factor</strong> (<em>int</em>) – Factor by which to scale the output raster dimensions.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="torchtrees.modules.utils.overlay_heatmap">
<span class="sig-prename descclassname"><span class="pre">torchtrees.modules.utils.</span></span><span class="sig-name descname"><span class="pre">overlay_heatmap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entropy_map</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchtrees/modules/utils.html#overlay_heatmap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchtrees.modules.utils.overlay_heatmap" title="Link to this definition"></a></dt>
<dd><p>Overlay an entropy heatmap on top of the image and save the result.</p>
<p>Parameters:
- image: Original image (as a NumPy array or PIL image).
- entropy_map: 2D array representing the entropy values.
- output_path: Path to save the overlaid image.
- filename: Name of the file to save the overlaid image.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="torchtrees.modules.utils.predict_on_array">
<span class="sig-prename descclassname"><span class="pre">torchtrees.modules.utils.</span></span><span class="sig-name descname"><span class="pre">predict_on_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_bands</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_border</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batchsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'float32'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cuda'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">augmentation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">report_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchtrees/modules/utils.html#predict_on_array"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchtrees.modules.utils.predict_on_array" title="Link to this definition"></a></dt>
<dd><p>Applies a pytorch segmentation model to an array in a strided manner.</p>
<p>Call model.eval() before use!</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – Pytorch model - make sure to call model.eval() before using this function!</p></li>
<li><p><strong>arr</strong> (<em>np.ndarray</em>) – HWC array for which the segmentation should be created.</p></li>
<li><p><strong>in_shape</strong> (<em>tuple</em>) – Input shape.</p></li>
<li><p><strong>out_bands</strong> (<em>int</em>) – Number of output bands.</p></li>
<li><p><strong>stride</strong> (<em>int</em>) – Stride with which the model should be applied. Default: output size.</p></li>
<li><p><strong>drop_border</strong> (<em>int</em>) – Number of pixels to drop from the border.</p></li>
<li><p><strong>batchsize</strong> (<em>int</em>) – Number of images to process in parallel.</p></li>
<li><p><strong>dtype</strong> (<em>str</em>) – Desired output type (default: float32).</p></li>
<li><p><strong>device</strong> (<em>str</em>) – Device to run on (default: cuda).</p></li>
<li><p><strong>augmentation</strong> (<em>bool</em>) – Whether to average over rotations and mirrorings of the image or not.</p></li>
<li><p><strong>no_data</strong> – A no-data value. It’s used to compute the area containing data via the first input image channel.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – Whether or not to display progress.</p></li>
<li><p><strong>report_time</strong> (<em>bool</em>) – If true, returns (result, execution time).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An array containing the segmentation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="torchtrees.modules.utils.predict_on_array_cf">
<span class="sig-prename descclassname"><span class="pre">torchtrees.modules.utils.</span></span><span class="sig-name descname"><span class="pre">predict_on_array_cf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_bands</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_border</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batchsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">64</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'float32'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cuda'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">augmentation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aggregate_metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchtrees/modules/utils.html#predict_on_array_cf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchtrees.modules.utils.predict_on_array_cf" title="Link to this definition"></a></dt>
<dd><p>Applies a pytorch segmentation model to an array in a strided manner.</p>
<p>Channels first version.</p>
<p>Call model.eval() before use!</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – Pytorch model - make sure to call model.eval() before using this function!</p></li>
<li><p><strong>arr</strong> (<em>np.ndarray</em>) – CHW array for which the segmentation should be created.</p></li>
<li><p><strong>in_shape</strong> (<em>tuple</em>) – Input shape.</p></li>
<li><p><strong>out_bands</strong> (<em>int</em>) – Number of output bands.</p></li>
<li><p><strong>stride</strong> (<em>int</em>) – Stride with which the model should be applied. Default: output size.</p></li>
<li><p><strong>drop_border</strong> (<em>int</em>) – Number of pixels to drop from the border.</p></li>
<li><p><strong>batchsize</strong> (<em>int</em>) – Number of images to process in parallel.</p></li>
<li><p><strong>dtype</strong> (<em>str</em>) – Desired output type (default: float32).</p></li>
<li><p><strong>device</strong> (<em>str</em>) – Device to run on (default: cuda).</p></li>
<li><p><strong>augmentation</strong> (<em>bool</em>) – Whether to average over rotations and mirrorings of the image or not.</p></li>
<li><p><strong>no_data</strong> – A no-data vector. Its length must match the number of layers in the input array.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – Whether or not to display progress.</p></li>
<li><p><strong>aggregate_metric</strong> (<em>bool</em>) – If true, returns (result, metric).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dict containing result, time, nodata_region and time.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="torchtrees.modules.utils.predict_on_tile">
<span class="sig-prename descclassname"><span class="pre">torchtrees.modules.utils.</span></span><span class="sig-name descname"><span class="pre">predict_on_tile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">256</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">local_batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchtrees/modules/utils.html#predict_on_tile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchtrees.modules.utils.predict_on_tile" title="Link to this definition"></a></dt>
<dd><p>Predict on a single tile of arbitrary dimension.</p>
<p>The tile is split into smaller patches that satisfy the criterion given by the segmentation model
that edge length must be divisible by 32. The stride parameter controls the overlap of these small patches.
Inference is run on all small patches in a memory-efficient way. The output is collected and weighted
with the pyramid weight function to reduce artefacts where the patches overlap.</p>
<p>The output tensor contains mask, outline, and distance transform in the same shape as the input tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – Trained TorchTrees model.</p></li>
<li><p><strong>input_tensor</strong> (<em>torch.Tensor</em>) – Tensor with the values of the raster tile.</p></li>
<li><p><strong>patch_size</strong> (<em>int</em><em>, </em><em>optional</em>) – Patch size used in inference. Defaults to 256.</p></li>
<li><p><strong>local_batch_size</strong> (<em>int</em><em>, </em><em>optional</em>) – Length of the batch of patches. Defaults to 32.</p></li>
<li><p><strong>stride</strong> (<em>int</em><em>, </em><em>optional</em>) – Apply patches in a strided manner. Defaults to 128.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Model output for the input raster.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="torchtrees.modules.utils.read_img">
<span class="sig-prename descclassname"><span class="pre">torchtrees.modules.utils.</span></span><span class="sig-name descname"><span class="pre">read_img</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim_ordering</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'HWC'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'float32'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">band_mapping</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_extent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchtrees/modules/utils.html#read_img"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchtrees.modules.utils.read_img" title="Link to this definition"></a></dt>
<dd><p>Reads an image from disk and returns it as numpy array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_file</strong> (<em>str</em>) – Path to the input file.</p></li>
<li><p><strong>dim_ordering</strong> (<em>str</em>) – One of HWC or CHW, C=Channels, H=Height, W=Width.</p></li>
<li><p><strong>dtype</strong> (<em>str</em>) – Desired data type for loading, e.g. np.uint8, np.float32.</p></li>
<li><p><strong>band_mapping</strong> (<em>dict</em>) – Dictionary of which image band to load into which array band.</p></li>
<li><p><strong>return_extent</strong> (<em>bool</em>) – Whether or not to return the raster extent in the form (ymin, ymax, xmin, xmax).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Numpy array containing the image and optionally the extent.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="torchtrees.modules.utils.save_polygons">
<span class="sig-prename descclassname"><span class="pre">torchtrees.modules.utils.</span></span><span class="sig-name descname"><span class="pre">save_polygons</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">polygons</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dest_fname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">driver</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'SQLite'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'w'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchtrees/modules/utils.html#save_polygons"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchtrees.modules.utils.save_polygons" title="Link to this definition"></a></dt>
<dd><p>Save a list of polygons into a shapefile with given coordinate reference system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>polygons</strong> (<em>list</em>) – List of shapely polygons to save.</p></li>
<li><p><strong>dest_fname</strong> (<em>str</em>) – Path to file.</p></li>
<li><p><strong>crs</strong> – Coordinate reference system, e.g. from fiona.crs.from_epsg().</p></li>
<li><p><strong>driver</strong> (<em>str</em>) – One of fiona’s supported drivers e.g. ‘ESRI Shapefile’ or ‘SQLite’.</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – Either ‘w’ for write or ‘a’ for append. Not all drivers support both.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="torchtrees.modules.utils.set_batchnorm_momentum">
<span class="sig-prename descclassname"><span class="pre">torchtrees.modules.utils.</span></span><span class="sig-name descname"><span class="pre">set_batchnorm_momentum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">momentum</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchtrees/modules/utils.html#set_batchnorm_momentum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchtrees.modules.utils.set_batchnorm_momentum" title="Link to this definition"></a></dt>
<dd><p>Set the momentum for all BatchNorm layers in the given model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – The model (either scripted or non-scripted) where batchnorm layers are modified.</p></li>
<li><p><strong>momentum</strong> – The momentum value to set for the BatchNorm layers.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="torchtrees.modules.utils.write_info_file">
<span class="sig-prename descclassname"><span class="pre">torchtrees.modules.utils.</span></span><span class="sig-name descname"><span class="pre">write_info_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchtrees/modules/utils.html#write_info_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchtrees.modules.utils.write_info_file" title="Link to this definition"></a></dt>
<dd><p>Writes key-value pairs to a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<em>str</em>) – The path to the file.</p></li>
<li><p><strong>**kwargs</strong> – Key-value pairs to write to the file.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="torchtrees.modules.utils.xarray_trafo_to_gdal_trafo">
<span class="sig-prename descclassname"><span class="pre">torchtrees.modules.utils.</span></span><span class="sig-name descname"><span class="pre">xarray_trafo_to_gdal_trafo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xarray_trafo</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/torchtrees/modules/utils.html#xarray_trafo_to_gdal_trafo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torchtrees.modules.utils.xarray_trafo_to_gdal_trafo" title="Link to this definition"></a></dt>
<dd><p>Converts an xarray transform to a GDAL transform.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>xarray_trafo</strong> – The xarray transform.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The GDAL transform.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-torchtrees.modules">
<span id="contents"></span><h2>Contents<a class="headerlink" href="#module-torchtrees.modules" title="Link to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="torchtrees.model.html" class="btn btn-neutral float-left" title="torchtrees.model" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Taimur Khan, Caroline Arnold, Harsh Grover.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>